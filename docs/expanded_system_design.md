# 修仙游戏完整系统设计 - 境界/门派/属性

## 一、境界体系设计（参考凡人修仙传）

### 1.1 完整境界等级（13大境界）

| 序号 | 境界名称 | 等级范围 | 突破条件 | 战力倍率 | 特殊能力 |
|------|---------|---------|---------|---------|---------|
| 1 | **炼气期** | 1-9层 | 灵根觉醒 | 1x | 感应灵气 |
| 2 | **筑基期** | 10-39 | 筑基丹+天地灵气 | 10x | 御器飞行 |
| 3 | **金丹期** | 40-79 | 凝结金丹 | 50x | 金丹护体 |
| 4 | **元婴期** | 80-119 | 碎丹成婴 | 200x | 元婴出窍 |
| 5 | **化神期** | 120-159 | 元婴化神 | 500x | 神识外放 |
| 6 | **炼虚期** | 160-199 | 炼虚合道 | 1000x | 空间穿梭 |
| 7 | **合体期** | 200-259 | 神魂合体 | 3000x | 分身术 |
| 8 | **大乘期** | 260-329 | 法力圆满 | 8000x | 法则感知 |
| 9 | **渡劫期** | 330-399 | 渡九重天劫 | 20000x | 天劫淬体 |
| 10 | **真仙境** | 400-499 | 飞升仙界 | 50000x | 仙力护体 |
| 11 | **金仙境** | 500-649 | 金仙证道 | 150000x | 不朽之躯 |
| 12 | **太乙境** | 650-849 | 太乙之道 | 500000x | 时间法则 |
| 13 | **大罗境** | 850-999+ | 大罗金仙 | 2000000x | 因果法则 |

### 1.2 境界细分（每个境界4小阶）

每个大境界分为：
- **初期** (0-25%)
- **中期** (25-50%)
- **后期** (50-75%)
- **大圆满** (75-100%)

```
示例：筑基期
├── 筑基初期 (Lv.10-17)
├── 筑基中期 (Lv.18-25)
├── 筑基后期 (Lv.26-33)
└── 筑基大圆满 (Lv.34-39)
```

### 1.3 境界突破系统

```python
class RealmBreakthrough:
    realm: str                    # 境界名称
    stage: str                    # 阶段 (初期/中期/后期/大圆满)

    # 突破条件
    required_exp: int             # 所需经验
    required_items: List[str]     # 所需丹药/材料
    success_rate: float           # 基础成功率
    failure_penalty: str          # 失败惩罚

    # 突破效果
    stat_multiplier: float        # 属性倍率
    new_abilities: List[str]      # 解锁能力
    skill_slots: int              # 技能槽位增加
```

---

## 二、八大门派设计

### 2.1 门派总览

| 门派 | 元素 | 特色 | 地理位置 | 创派祖师 |
|------|------|------|---------|---------|
| **青云门** | 风 | 剑道、速度 | 东海青云山 | 青云子 |
| **丹鼎门** | 火 | 炼丹、爆发 | 南荒火山 | 丹霞真人 |
| **万花谷** | 木 | 治疗、毒术 | 西域花海 | 百花仙子 |
| **逍遥宗** | 虚 | 隐匿、控制 | 北冥虚境 | 逍遥子 |
| **蜀山派** | 雷 | 剑阵、群攻 | 中土蜀山 | 长眉真人 |
| **昆仑派** | 冰 | 冰封、防御 | 西极昆仑 | 昆仑老祖 |
| **幻音坊** | 音 | 音律、幻术 | 南疆幻境 | 幻音仙子 |
| **血魔宗** | 血 | 吸血、狂暴 | 东域血海 | 血魔老祖 |

### 2.2 各门派五大流派

#### 青云门（风系·剑道至尊）
| 流派 | 核心 | 主属性 | 特色技能 |
|------|------|--------|---------|
| **御风流** | 速度+闪避 | 敏捷 | 风行术、御风剑诀、瞬影千重 |
| **青云剑宗** | 暴击+穿透 | 力量 | 青云剑气、破甲剑、斩龙诀 |
| **云遁流** | 生存+机动 | 体质 | 云遁术、风墙、云雾迷踪 |
| **剑心流** | 剑意+爆发 | 悟性 | 剑心通明、万剑归宗、一剑破万法 |
| **天风流** | AOE+控制 | 智力 | 狂风术、风卷残云、暴风领域 |

#### 丹鼎门（火系·丹道无双）
| 流派 | 核心 | 主属性 | 特色技能 |
|------|------|--------|---------|
| **烈火宗** | 火焰伤害 | 智力 | 三昧真火、炎龙术、焚天诀 |
| **丹修流** | 辅助+恢复 | 悟性 | 炼丹术、回春丹、九转金丹 |
| **鼎甲流** | 防御+反伤 | 体质 | 金鼎护体、反震、不动明王 |
| **火毒流** | DOT+Debuff | 敏捷 | 火毒术、灼烧、剧炎蚀骨 |
| **炼器流** | 装备强化 | 力量 | 炼器术、附魔、神兵锻造 |

#### 万花谷（木系·医毒双绝）
| 流派 | 核心 | 主属性 | 特色技能 |
|------|------|--------|---------|
| **医仙流** | 治疗+复活 | 悟性 | 万花医术、起死回生、甘霖普降 |
| **毒宗** | 毒素+DOT | 智力 | 毒雾、万毒噬心、碧落黄泉 |
| **花灵流** | 召唤+控制 | 体质 | 花灵召唤、花海、花语缠绵 |
| **藤蔓流** | 控制+缠绕 | 力量 | 藤蔓术、荆棘甲、缠绕领域 |
| **生命流** | 续航+护盾 | 敏捷 | 生命汲取、自然护盾、枯木逢春 |

#### 逍遥宗（虚系·逍遥自在）
| 流派 | 核心 | 主属性 | 特色技能 |
|------|------|--------|---------|
| **逍遥游** | 移动+隐身 | 敏捷 | 逍遥步、无相功、踏雪无痕 |
| **虚空流** | 控制+爆发 | 智力 | 虚空斩、破空击、虚空裂痕 |
| **心魔流** | Debuff+幻术 | 悟性 | 心魔入侵、幻境、惑心术 |
| **太极流** | 反弹+平衡 | 体质 | 太极图、乾坤倒转、阴阳调和 |
| **梦魇流** | 精神攻击 | 力量 | 梦魇术、噬魂、困梦千年 |

#### 蜀山派（雷系·剑阵无双）
| 流派 | 核心 | 主属性 | 特色技能 |
|------|------|--------|---------|
| **剑宗** | 纯攻击 | 力量 | 蜀山剑法、天剑、万剑归宗 |
| **御剑流** | 远程+AOE | 智力 | 御剑术、剑阵、天剑降魔 |
| **剑盾流** | 攻守平衡 | 体质 | 剑盾合一、金刚护体、不动如山 |
| **雷剑流** | 雷霆+麻痹 | 敏捷 | 雷剑术、紫霄神雷、引雷诀 |
| **剑意流** | 剑意+Buff | 悟性 | 剑意化形、剑气纵横、剑神降世 |

#### 昆仑派（冰系·冰封万里）
| 流派 | 核心 | 主属性 | 特色技能 |
|------|------|--------|---------|
| **冰封流** | 冻结+控制 | 智力 | 冰封术、绝对零度、万里冰封 |
| **玄冰流** | 防御+护盾 | 体质 | 玄冰甲、冰晶护盾、寒冰领域 |
| **雪舞流** | AOE+减速 | 敏捷 | 漫天飞雪、暴风雪、雪崩 |
| **霜华流** | 爆发+穿透 | 力量 | 霜华剑、冰心诀、寒霜破 |
| **极光流** | 辅助+增益 | 悟性 | 极光术、冰心通明、寒玉功 |

#### 幻音坊（音系·音律入道）
| 流派 | 核心 | 主属性 | 特色技能 |
|------|------|--------|---------|
| **琴音流** | 治疗+增益 | 悟性 | 琴音疗伤、高山流水、琴心剑胆 |
| **箫声流** | 控制+幻术 | 智力 | 箫声惑心、魔音贯耳、引魂箫 |
| **鼓乐流** | 爆发+Debuff | 力量 | 战鼓震天、破阵乐、惊雷鼓 |
| **铃音流** | 召唤+附灵 | 体质 | 铃音唤灵、摄魂铃、风铃术 |
| **音刃流** | 音波攻击 | 敏捷 | 音刃术、回音击、音爆 |

#### 血魔宗（血系·以血证道）
| 流派 | 核心 | 主属性 | 特色技能 |
|------|------|--------|---------|
| **血魔流** | 吸血+狂暴 | 力量 | 血魔噬、血影遁、血魔化身 |
| **血海流** | AOE+召唤 | 智力 | 血海术、血灵召唤、血海滔天 |
| **血甲流** | 防御+反伤 | 体质 | 血甲术、鲜血护盾、血盾反震 |
| **诅咒流** | Debuff+DOT | 悟性 | 诅咒术、血咒、天魔解体 |
| **嗜血流** | 爆发+续航 | 敏捷 | 嗜血术、血祭、浴血奋战 |

---

## 三、五行属性系统（参考暗黑3/4）

### 3.1 基础属性（五大主属性）

| 属性 | 对应五行 | 效果 | 每点收益 |
|------|---------|------|---------|
| **力量** | 金 | 物理攻击、护甲穿透 | +1%攻击、+0.5%穿透 |
| **敏捷** | 木 | 速度、暴击率、闪避 | +0.5%速度、+0.2%暴击、+0.3%闪避 |
| **体质** | 土 | 生命值、防御、减伤 | +10生命、+0.5%防御、+0.1%减伤 |
| **智力** | 水 | 法术攻击、灵力上限 | +1%法攻、+5灵力 |
| **悟性** | 火 | 修炼速度、技能效果、冷却 | +0.5%修炼、+0.3%技能效果、-0.1%CD |

### 3.2 五行属性（元素系统）

```python
class FiveElements:
    """五行属性"""
    metal: int = 0    # 金 - 物理穿透、破甲
    wood: int = 0     # 木 - 治疗、恢复、生长
    water: int = 0    # 水 - 法力、冰霜、控制
    fire: int = 0     # 火 - 燃烧、爆发、伤害
    earth: int = 0    # 土 - 防御、护盾、减伤
```

#### 五行相生相克

```
相生（+30%效果）:
金 → 水 → 木 → 火 → 土 → 金

相克（+50%伤害）:
金 → 木 → 土 → 水 → 火 → 金
```

### 3.3 战斗属性（暗黑风格）

#### 进攻属性
| 属性 | 说明 | 获取来源 |
|------|------|---------|
| **物理攻击** | 基础物理伤害 | 武器、力量 |
| **法术攻击** | 基础法术伤害 | 法器、智力 |
| **攻击速度** | 每秒攻击次数 | 装备、敏捷 |
| **暴击率** | 暴击概率 (0-100%) | 装备、被动 |
| **暴击伤害** | 暴击时伤害倍率 (150%+) | 装备、被动 |
| **命中率** | 命中概率 | 敏捷、装备 |
| **穿透** | 无视防御比例 | 力量、金属性 |
| **范围伤害** | AOE额外伤害 | 装备、技能 |

#### 防御属性
| 属性 | 说明 | 获取来源 |
|------|------|---------|
| **生命值** | 最大HP | 体质、装备 |
| **灵力值** | 技能消耗资源 | 智力、装备 |
| **护甲** | 物理减伤 | 装备、土属性 |
| **全抗性** | 元素减伤 | 装备、五行 |
| **闪避率** | 躲避攻击概率 | 敏捷、被动 |
| **格挡率** | 格挡概率 | 盾牌、被动 |
| **格挡值** | 格挡减伤 | 盾牌、力量 |
| **伤害减免** | 直接减伤% | 被动、套装 |
| **生命回复** | 每秒恢复 | 装备、木属性 |

#### 特殊属性
| 属性 | 说明 | 获取来源 |
|------|------|---------|
| **冷却缩减** | 技能CD减少 (0-75%) | 装备、悟性 |
| **资源消耗降低** | 灵力消耗减少 | 装备、被动 |
| **移动速度** | 移动速度加成 | 装备、敏捷 |
| **拾取半径** | 自动拾取范围 | 装备 |
| **经验获取** | 经验加成% | 装备、VIP |
| **金币获取** | 仙石加成% | 装备、VIP |
| **魔法找到** | 稀有装备概率 | 装备 |
| **黄金找到** | 仙石掉落概率 | 装备 |

### 3.4 元素属性（详细）

```python
class ElementalAttributes:
    """元素属性"""
    # 元素伤害
    fire_damage: int = 0        # 火焰伤害
    ice_damage: int = 0         # 冰霜伤害
    lightning_damage: int = 0   # 雷电伤害
    poison_damage: int = 0      # 毒素伤害（每秒）
    holy_damage: int = 0        # 神圣伤害
    shadow_damage: int = 0      # 暗影伤害

    # 元素抗性
    fire_resist: int = 0        # 火焰抗性
    ice_resist: int = 0         # 冰霜抗性
    lightning_resist: int = 0   # 雷电抗性
    poison_resist: int = 0      # 毒素抗性
    holy_resist: int = 0        # 神圣抗性
    shadow_resist: int = 0      # 暗影抗性

    # 特殊效果
    burn_chance: float = 0      # 燃烧概率
    freeze_chance: float = 0    # 冻结概率
    shock_chance: float = 0     # 麻痹概率
    poison_chance: float = 0    # 中毒概率
```

### 3.5 属性计算公式

```python
class StatCalculator:
    @staticmethod
    def calculate_damage(attacker, defender, skill):
        """计算伤害"""
        # 基础伤害
        if skill.damage_type == "physical":
            base_damage = attacker.physical_attack
            defense = defender.armor
        else:
            base_damage = attacker.magic_attack
            defense = defender.magic_resist

        # 穿透计算
        armor_pen = attacker.armor_penetration / 100
        effective_defense = defense * (1 - armor_pen)

        # 伤害减免
        base_damage = max(1, base_damage - effective_defense)
        damage_reduction = defender.damage_reduction / 100
        final_damage = base_damage * (1 - damage_reduction)

        # 暴击判定
        if random.random() < attacker.crit_rate:
            final_damage *= (1 + attacker.crit_damage / 100)

        # 元素克制
        element_multiplier = get_element_multiplier(attacker.element, defender.element)
        final_damage *= element_multiplier

        # 技能倍率
        final_damage *= skill.damage_multiplier

        return int(final_damage)
```

---

## 四、属性成长系统

### 4.1 升级属性点

每升一级获得属性点：
```
1-9级:   +3 属性点/级
10-39级: +5 属性点/级
40-79级: +7 属性点/级
80级+:   +10 属性点/级
```

### 4.2 境界突破属性

```
炼气→筑基: +50 全属性
筑基→金丹: +100 全属性
金丹→元婴: +200 全属性
元婴→化神: +400 全属性
化神→炼虚: +800 全属性
...
```

### 4.3 属性上限

| 境界 | 主属性上限 | 五行属性上限 |
|------|-----------|-------------|
| 炼气期 | 100 | 50 |
| 筑基期 | 300 | 150 |
| 金丹期 | 800 | 400 |
| 元婴期 | 2000 | 1000 |
| 化神期+ | 无上限 | 无上限 |

---

## 五、实现计划

### P0 - 核心框架
- [ ] 13境界枚举和数据结构
- [ ] 8门派枚举和基础数据
- [ ] 40流派基础框架
- [ ] 五行属性系统

### P1 - 数据填充
- [ ] 境界突破条件
- [ ] 门派详细设定
- [ ] 流派技能树
- [ ] 属性词缀配置

### P2 - 平衡调整
- [ ] 数值平衡
- [ ] 相克关系
- [ ] 成长曲线

---

**文档版本**: 2.0
**创建时间**: 2026-02-11
